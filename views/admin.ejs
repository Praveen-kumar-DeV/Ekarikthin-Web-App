<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.3.0/axios.min.js" 
    integrity="sha512-A6BG70odTHAJYENyMrDN6Rq+Zezdk+dFiFFN6jH1sB+uJT3SYMV4zDSVR+7VawJzvq7/IrT/2K3YWVKRqOyN0Q=="
     crossorigin="anonymous" referrerpolicy="no-referrer"></script>
   
     <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
     <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
  <link rel="stylesheet" href="/public/src/css/style.css">
  
    <title>Admin</title>
</head>
<body>
  <section>
      <div class="container">
        <form  >
          
          <div class="step step-1 active">
              <legend>Admin Login</legend>
            <div class="form-group">
              <label for="username">username</label>
              <input type="text" id="username" name="username" value="" autocomplete="off">
            </div>
            <div class="form-group">
              <label for="password">Password</label>
              <input type="password" id="password" name="password" value="" autocomplete="off">
            </div>
           
            <button type="submit" class="submit-btn">Log In</button>
          </div>
    
        </form>
      </div>
    </section>
   
      <div id="result"></div>
</body>
<script>


let allregis;
$(document).ready(function() {
  $('form').submit(async function(event) {
      event.preventDefault();
let username = $('#username').val();
let password=$('#password').val();
  
const regForm={username:username,password:password};
try{
const { data } = await axios.post("/admin/login", regForm);


const token =data.token;
if (data.success) {
      const userDetails = {
       ...data.user,
         token:data.token,
      };
      localStorage.setItem("user", JSON.stringify(userDetails));
     

    console.log("test token...",userDetails.role);
    if(userDetails.role==='admin'){
      console.log(userDetails.role);
    window.location.href = '/admin/DashBoard?valid='+userDetails.token;
    }
    else if(userDetails.role==='head')
    {
      window.location.href = '/admin/headUserDash?valid='+userDetails.token;
    }
    else 
    {
      window.location.href = '/admin/UserDash?valid='+userDetails.token;
    }
    
    
   
}
}
catch(err){
console.log(err.response.data.message);
Toastify({
        text:err.response.data.message,
        duration: 3000,
        
        newWindow: true,
        close: true,
        gravity: "top", 
        position: "right", 
        stopOnFocus: true,
        style: {
          background: "linear-gradient(to right, #ff0000, #ff4122)",
        },
        onClick: function(){} 
      }).showToast();
}

  });
});


</script>
 





</html>